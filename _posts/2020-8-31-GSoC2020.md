---
layout: post
title: GSoC 2020
---

During GSoC 2020 I had the pleasure to work with the Honeynet Project, in particular on Cuckoo, their well known malware sandbox project. The project’s name was titled 'Analytical Malware Classification' and was mentored by [Ricardo van Zutphen](https://github.com/RicoVZ).

## Description

Cuckoo Sandbox is currently undergoing a complete redesign, the new version will be released in the coming months. The goal of the project was to build a proof of concept module that uses an analytical approach to classify malware behavior into one or more categories. 

This included a lot of research on particular malware categories and getting familiar with the new Cuckoo architecture, especially with Threemon, the new data structure Cuckoo is using for its analysis results, which is based on [Google’s protocol buffer language](https://developers.google.com/protocol-buffers/docs/overview), which makes it possible to streams events directly from Threemon. 

The PoC takes a Threemon file as input, analysis every event, tries to match the events to malicious behavior and classifies the analyzed sample to one or more categories. While the first version during the project required the user to convert the Threemon file to a json formatted output for further analysis, the second version is able to parse the events directly from the proto buf. 

* [View source on GitHub](https://github.com/agiix/analytical-malware-classification)
* [View usage example](https://github.com/agiix/analytical-malware-classification)

## What has been done so far

* Strongly researched Ransomware behavior [here](https://github.com/agiix/analytical-malware-classification/blob/master/malware/ransomware/classification.md) 
* I documented the stats of every analyzed Ransomware sample with Cuckoo [here](https://github.com/agiix/analytical-malware-classification/tree/master/malware/ransomware/stats)
* Researched Emotet behavior [here](https://github.com/agiix/analytical-malware-classification/blob/master/malware/trojan/emotet/readme.md)
* I documented the stats of every analyzed Emotet sample with Cuckoo [here](https://github.com/agiix/analytical-malware-classification/tree/master/malware/trojan/emotet/stats)
* Created a Python script that parses Threemon events from a proto-buf file, matches the events to sigantures and outputs a summary for the user [here](https://github.com/agiix/analytical-malware-classification/blob/master/onemonparser.py)
* Added PDF report feature [here](https://github.com/agiix/analytical-malware-classification/blob/master/report.py)
* Added TTP [here](https://github.com/agiix/analytical-malware-classification/blob/master/ttps.json) and malware category description [here](https://github.com/agiix/analytical-malware-classification/blob/master/malware-description.json)

## What needs to be done in the future

* The malware categorization is currently done by simply matching each TTP to a particular malware category, which is prone to false positives. It is therefore important to create a more precise approach 
* A scoring system, like in the previous Cuckoo versions, that gives each analyzed sample a score, for example from 1 to 10, to indicate, how malicious the captured events are
* More signatures and updates to the already existing ones

## Attribution
I want to thank the Honeynet Projet and the awesome team at Hatching for this unique and awesome oppurtunity. You are the best at what you are doing. 

My biggest thanks goes to my mentor Ricardo, for the great time while working on the project. You are clearly an expert in what you are doing and I learned so much from you. I couldn't have asked for a better mentor, keep up the great work!

I am looking forward to keep contributing to this great community and project. 
